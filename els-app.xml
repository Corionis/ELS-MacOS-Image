<?xml version="1.0" encoding="UTF-8"?>
<project name="ELS MacOS .app Build" default="All" basedir=".">

    <!-- https://github.com/TheInfiniteKind/appbundler -->
    <taskdef name="bundleapp"
             classpath="appbundler-1.0ea.jar"
             classname="com.oracle.appbundler.AppBundlerTask"/>

    <target name="init">
        <property file="els.properties"/>
        <property file="ELS/build-stamp.properties"/>
        <echo message="ELS version ${els.version.name}" level="info"/>
        <echo message="${java.vendor} ${java.runtime.name} ${java.runtime.version}" level="info"/>
        <echo message="${ant.version}" level="info"/>
    </target>

    <target name="clean" depends="init">
        <delete file="*.dmg" failonerror="false"/>
        <delete dir="ELS.app" failonerror="false"/>
    </target>

    <!-- Build ELS macOS .dmg -->
    <target name="els-macos" depends="clean">
        <echo message="${els.version.name}, ${els.build.stamp}" level="info"/>
        <bundleapp
                outputdirectory="."
                executableName="ELS-Navigator"
                name="ELS"
                displayname="Entertainment Library Synchronizer"
                identifier="com.corionis.els"
                shortversion="${els.version.name}, ${els.build.stamp}"
                icon="./els-logo-98px.icns"
                mainclassname="com.corionis.els.Main"
                copyright="https://github.com/Corionis/ELS"
                applicationCategory="public.app-category.utilities"
        >
            <classpath file="ELS/bin/ELS.jar" />
            <runtime dir="ELS/rt/Contents/Home"/>
        </bundleapp>
        <copy file="ELS/bin/update.info" todir="ELS.app/Contents" preservelastmodified="true"/>
        <copy file="ELS/bin/els-logo-98px.icns" todir="ELS.app/Contents" preservelastmodified="true"/>
        <copy file="ELS/License.txt" todir="ELS.app/Contents" preservelastmodified="true"/>
        <copy file="ELS/Notice.txt" todir="ELS.app/Contents" preservelastmodified="true"/>

    </target>

    <!-- ELS Updater ========================================== -->


    <!-- Primary Targets ========================================== -->

    <target name="All" depends="els-macos" description="Build all deliverables"/>

</project>
